{"ast":null,"code":"import _slicedToArray from\"/home/ilkyu/akpl/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectDestructuringEmpty from\"/home/ilkyu/akpl/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";import React,{useState}from'react';import axios from'axios';import{IonList,IonItem,IonLabel,IonItemDivider,IonText,IonSearchbar,useIonViewWillEnter,IonToggle}from'@ionic/react';var HateCommentsContainer=function HateCommentsContainer(_ref){_objectDestructuringEmpty(_ref);var _useState=useState(),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),busy=_useState4[0],setBusy=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),showHateOnly=_useState6[0],setShowHateOnly=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),comments=_useState8[0],setComments=_useState8[1];var _useState9=useState(\"이효리\"),_useState10=_slicedToArray(_useState9,2),keyword=_useState10[0],setKeyword=_useState10[1];useIonViewWillEnter(function(){updateComments(keyword,showHateOnly);});var API_URL='http://akpl.ilkyu.kr:8080/find/';var EXPORT_URL='http://akpl.ilkyu.kr:8080/export/';var getBgColor=function getBgColor(prob){prob*=100;if(prob<50){return\"secondary\";}else if(prob<60){return\"success\";}else if(prob<70){return\"warning\";}else{return\"danger\";}};var updateComments=function updateComments(keyword,_hateOnly){var hateOnly=_hateOnly?\"1\":\"0\";setBusy(true);axios.get(API_URL+keyword+\"/\"+100+\"/\"+hateOnly).then(function(resp){return resp.data;}).then(function(data){setComments(data);});setBusy(false);};var showHateOnlyChecked=function showHateOnlyChecked(checked){setShowHateOnly(checked);updateComments(keyword,checked);};var exportComments=function exportComments(){var hateOnly=showHateOnly?\"1\":\"0\";axios({url:EXPORT_URL+keyword+\"/\"+hateOnly,method:'GET',responseType:'blob'}).then(function(resp){var type=resp.headers['content-type'];var url=window.URL.createObjectURL(new Blob([resp.data],{type:type}));var link=document.createElement('a');link.href=url;link.setAttribute('download','akpl_'+keyword+'.xlsx');document.body.appendChild(link);link.click();});};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(IonItemDivider,null,\"\\uC544\\uB798\\uC5D0 \\uAC80\\uC0C9\\uD560 \\uD0A4\\uC6CC\\uB4DC\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694\"),/*#__PURE__*/React.createElement(IonSearchbar,{placeholder:\"\\uC774\\uD6A8\\uB9AC\",onIonChange:function onIonChange(e){updateComments(e.detail.value,showHateOnly);setKeyword(e.detail.value);}}),/*#__PURE__*/React.createElement(IonItemDivider,null,/*#__PURE__*/React.createElement(IonItem,null,\"\\uC545\\uD50C\\uB9CC \\uBCF4\\uAE30\",/*#__PURE__*/React.createElement(IonToggle,{checked:showHateOnly,onIonChange:function onIonChange(e){showHateOnlyChecked(e.detail.checked);},color:\"danger\"}))),/*#__PURE__*/React.createElement(IonItemDivider,null,/*#__PURE__*/React.createElement(IonItem,{button:true,onClick:function onClick(){return exportComments();}},\"\\uB0B4\\uBCF4\\uB0B4\\uAE30 (.xlsx)\")),/*#__PURE__*/React.createElement(IonList,null,comments.map(function(comment,i){return/*#__PURE__*/React.createElement(IonItem,null,/*#__PURE__*/React.createElement(IonLabel,{className:\"ion-text-wrap\"},/*#__PURE__*/React.createElement(IonText,{color:getBgColor(comment.prob)},/*#__PURE__*/React.createElement(\"h1\",null,comment.text)),/*#__PURE__*/React.createElement(\"p\",null,\"\\uC791\\uC131\\uC790: \",comment.commenter,\" | \",comment.datetime),/*#__PURE__*/React.createElement(\"p\",null,\"\\uC6D0\\uAE00: \",comment.article_title,\" (\",/*#__PURE__*/React.createElement(\"a\",{target:\"_blank\",href:comment.article_url},comment.article_url),\")\")),/*#__PURE__*/React.createElement(IonText,{slot:\"start\",color:getBgColor(comment.prob)},/*#__PURE__*/React.createElement(\"h1\",null,Math.floor(comment.prob*100),\"%\")));})));};export default HateCommentsContainer;","map":{"version":3,"sources":["/home/ilkyu/akpl/src/components/HateCommentsContainer.tsx"],"names":["React","useState","axios","IonList","IonItem","IonLabel","IonItemDivider","IonText","IonSearchbar","useIonViewWillEnter","IonToggle","HateCommentsContainer","text","setText","busy","setBusy","showHateOnly","setShowHateOnly","comments","setComments","keyword","setKeyword","updateComments","API_URL","EXPORT_URL","getBgColor","prob","_hateOnly","hateOnly","get","then","resp","data","showHateOnlyChecked","checked","exportComments","url","method","responseType","type","headers","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","e","detail","value","map","comment","i","commenter","datetime","article_title","article_url","Math","floor"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\n\nimport { IonGrid, IonCol, IonRow, IonCard, IonList, IonCardTitle, IonTextarea, IonItem, IonLabel, IonButton, IonCardHeader, IonCardSubtitle, IonContent, IonListHeader, IonItemDivider, IonText, IonNote, IonSearchbar, useIonViewWillEnter, IonToggle } from '@ionic/react';\n\ninterface ContainerProps {\n\n}\n\ninterface Comment {\n    article_title: string;\n    article_url: string;\n    text: string;\n    prob: number;\n    commenter: string;\n    datetime: string;\n}\n\n\nconst HateCommentsContainer: React.FC<ContainerProps> = ({  }) => {\n\n  const [text, setText] = useState<string>();\n  const [busy, setBusy] = useState<boolean>(false);\n  const [showHateOnly, setShowHateOnly] = useState<boolean>(true);\n  const [comments, setComments] = useState<Comment[]>([]);\n  const [keyword, setKeyword] = useState<string>(\"이효리\");\n\n  useIonViewWillEnter(() => {\n    updateComments(keyword, showHateOnly); \n  })\n\n\n  const API_URL = 'http://akpl.ilkyu.kr:8080/find/';\n  const EXPORT_URL = 'http://akpl.ilkyu.kr:8080/export/'\n\n  const getBgColor = (prob:number) => {\n    prob *= 100\n    if (prob < 50){\n        return \"secondary\"\n    } else if (prob < 60){\n        return \"success\"\n    } else if (prob < 70){\n        return \"warning\"\n    } else {\n        return \"danger\"\n    }\n  }\n\n  const updateComments = (keyword:string, _hateOnly:boolean) => {\n    let hateOnly = _hateOnly ? \"1\" : \"0\"\n    setBusy(true);\n    axios.get(API_URL + keyword + \"/\" + 100 + \"/\" + hateOnly).then(resp => resp.data)\n        .then((data) => {\n            setComments(data)\n        })\n        setBusy(false)\n\n  }\n\n  const showHateOnlyChecked = (checked:boolean) => {\n      setShowHateOnly(checked);\n      updateComments(keyword, checked)\n  }\n\n  const exportComments = () => {\n      let hateOnly = showHateOnly ? \"1\" : \"0\"\n    axios({\n        url: EXPORT_URL + keyword + \"/\" + hateOnly,\n        method: 'GET',\n        responseType: 'blob',\n    }).then( (resp) => {\n        const type = resp.headers['content-type'];\n        const url = window.URL.createObjectURL(new Blob([resp.data], {type: type}));\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download', 'akpl_'+keyword+'.xlsx');\n        document.body.appendChild(link);\n        link.click();\n    })\n  }\n\n\n  return (\n    <div>\n        <IonItemDivider>아래에 검색할 키워드를 입력하세요</IonItemDivider>\n        <IonSearchbar placeholder=\"이효리\" onIonChange={e => {updateComments(e.detail.value!, showHateOnly); setKeyword(e.detail.value!)}}></IonSearchbar>\n        <IonItemDivider><IonItem>악플만 보기<IonToggle checked={showHateOnly} onIonChange={(e => {showHateOnlyChecked(e.detail.checked)})} color=\"danger\" /></IonItem></IonItemDivider>\n        <IonItemDivider><IonItem button onClick={() => exportComments()} >내보내기 (.xlsx)</IonItem></IonItemDivider>\n        <IonList>\n        {comments.map((comment, i) => (\n            <IonItem>\n                <IonLabel className=\"ion-text-wrap\">\n                    <IonText color={getBgColor(comment.prob)}>\n                    <h1>{comment.text}</h1>\n                    </IonText>\n                    <p>작성자: {comment.commenter} | {comment.datetime}</p>\n                    <p>원글: {comment.article_title} (<a target=\"_blank\" href={comment.article_url}>{comment.article_url}</a>)</p>\n\n                </IonLabel>\n                <IonText slot=\"start\" color={getBgColor(comment.prob)}><h1>{Math.floor(comment.prob*100)}%</h1></IonText>\n            </IonItem>\n        ))}\n        </IonList>\n    </div>\n  );\n};\n\nexport default HateCommentsContainer;\n"]},"metadata":{},"sourceType":"module"}